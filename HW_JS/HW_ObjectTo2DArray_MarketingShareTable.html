<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
        integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
</head>

<body>

    <div class="jumbotron bg-info">
        <h1>用Object資料轉成2DArray結合DOM API動態產生Table</h1>
    </div>
    <div id="container">

    </div>

    <!-- <table class="table table-bordered table-striped">
        <thead>
            <tr>
                <th>排名</th>
                <th>公司名稱</th>
                <th>國別</th>
                <th>市佔率</th>
            </tr>
        </thead>

        <tbody>
            <tr>
                <td>1</td>
                <td>台積電</td>
                <td>台灣</td>
                <td>53.1%</td>
            </tr>
        </tbody>
    </table> -->

    <script>
        const marketingShare = {
            publish: "2021/12/31",
            version: "1.0",
            titles: ["排名", "公司名稱", "國別", "市佔率"],
            data: [
                { Ranking: 1, Name: "台積電", Country: "台灣", Ratio: 53.1 },
                { Ranking: 2, Name: "三星電子", Country: "韓國", Ratio: 17.3 },
                { Ranking: 3, Name: "聯電", Country: "台灣", Ratio: 7.2 },
                { Ranking: 4, Name: "格羅方德", Country: "美國", Ratio: 6.1 },
                { Ranking: 5, Name: "中芯國際", Country: "中國", Ratio: 5.3 },
                { Ranking: 6, Name: "華虹半導體", Country: "中國", Ratio: 2.6 },
                { Ranking: 7, Name: "力積電", Country: "台灣", Ratio: 1.8 },
                { Ranking: 8, Name: "世界先進", Country: "台灣", Ratio: 1.4 },
                { Ranking: 9, Name: "高塔半導體", Country: "以色列", Ratio: 1.4 },
                { Ranking: 10, Name: "東部高科", Country: "南韓", Ratio: 1 }
            ]
        };

        let titles;
        let table;
        let thead;
        let tbody;
        let data2DArray=[];

        marketingShare.data.forEach((item)=>{
            let data=Object.values(item);
            data2DArray.push(data);
        })

        window.onload=function(){
            let container=document.getElementById('container');

            table=document.createElement('table');
            // table.setAttribute("class","table table-bordered table-striped table-dark");
            table.classList.add('table','table-bordered','table-striped','table-dark');
            thead=document.createElement('thead');
            tbody=document.createElement('tbody');

            createThead(marketingShare.titles);
            createTbody(data2DArray);

        }

        function createThead(titleArray){
            let theadTr=document.createElement('tr');

            titleArray.forEach((title,index)=>{
                let th=document.createElement('th');
                let thText=document.createTextNode(title);
                th.append(thText);
                theadTr.append(th);
            })
            thead.append(theadTr);
            table.append(thead);
            container.append(table);
        }

        function createTbody(_2DArray){
            _2DArray.forEach((rankarr)=>{
                let tr=document.createElement('tr');
                rankarr.forEach((item,index)=>{
                    let tBodytd=document.createElement('td');
                    tdText=document.createTextNode(item);
                    tBodytd.append(tdText);
                    tr.append(tBodytd);
                })
                tbody.append(tr);
            })
            table.append(tbody);
            container.append(table);
        }

    </script>
</body>

</html>